<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>SQL -> GAS Sync</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
    <style>
      body { margin: 24px; }
      .container { max-width: 700px; margin: 0 auto; }
      .form-label { font-weight: 500; }
      .section { margin-bottom: 2rem; }
      pre { background: #f6f6f6; padding: 12px; border-radius: 4px; }
    </style>
  </head>
  <body>
    <div class="container">
      <h1 class="my-4 text-center">SQL <span class="text-primary">â†’</span> GAS Sync Dashboard</h1>

      <div class="section card p-3 mb-4">
        <h4 class="mb-3">Configuration</h4>
        <div class="mb-3">
          <span class="fw-bold">GAS URL:</span> <span class="text-success">{{ gas_url or 'NOT SET' }}</span>
        </div>
        <form action="/set_gas_url" method="post" class="row g-2 align-items-center">
          <div class="col-8">
            <label for="gas" class="form-label">Set GAS URL:</label>
            <input id="gas" name="gas_url" type="text" class="form-control" value="{{ gas_url or '' }}" />
          </div>
          <div class="col-auto">
            <button type="submit" class="btn btn-primary">Save</button>
          </div>
        </form>
      </div>

      <div class="section card p-3 mb-4">
        <div class="mb-3">
          <span class="fw-bold">SQL Server:</span> <span class="text-info">{{ server_type or 'NOT SET' }}</span>
        </div>
        <form action="/set_server_type" method="post" class="row g-2 align-items-center">
          <div class="col-8">
            <label for="server_type" class="form-label">Select SQL Server:</label>
            <select id="server_type" name="server_type" class="form-select">
              <option value="DEFAULT" {% if server_type == 'DEFAULT' %}selected{% endif %}>localhost</option>
              <option value="EXPRESS" {% if server_type == 'EXPRESS' %}selected{% endif %}>localhost\SQLEXPRESS</option>
            </select>
          </div>
          <div class="col-auto">
            <button type="submit" class="btn btn-primary">Save</button>
          </div>
        </form>
      </div>

      <div class="section card p-3 mb-4">
        <form action="/refresh_databases" method="post">
          <button type="submit" class="btn btn-secondary">Refresh Databases</button>
        </form>
      </div>

      <div class="section card p-3 mb-4">
        <h4>Databases</h4>
        <ul class="list-group mb-0">
          {% for d in databases %}
            <li class="list-group-item">{{ d }}</li>
          {% else %}
            <li class="list-group-item text-danger">No databases discovered</li>
          {% endfor %}
        </ul>
      </div>

      <div class="section card p-3 mb-4">
        <h4>Sync a single database</h4>
        <form action="/sync_one" method="post" class="row g-2 align-items-center">
          <div class="col-8">
            <label for="db" class="form-label">Database:</label>
            <select id="db" name="database" class="form-select">
              {% for d in databases %}
                <option value="{{ d }}">{{ d }}</option>
              {% endfor %}
            </select>
          </div>
          <div class="col-auto">
            <button type="submit" class="btn btn-success">Sync</button>
          </div>
        </form>
      </div>

      <div class="section card p-3 mb-4">
        <h4>Sync all databases</h4>
        <form action="/sync_batch" method="post">
          <button type="submit" class="btn btn-success">Sync Batch</button>
        </form>
      </div>

      {% if message %}
        <div class="alert alert-info mt-4">
          <h5>Result</h5>
          <pre>{{ message }}</pre>
        </div>
      {% endif %}
    </div>
    <!-- Bootstrap JS (optional, for dropdowns etc.) -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
  </body>
</html>
